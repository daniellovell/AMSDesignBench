package analog.ota; import lib.motifs.*;

class OTACurrentMirror implements Amplifier {
  supply VDD=1.8V; ground GND;
  port in_p vinp, in_n vinn; port out vout; bias vbias_n;

  use {
    dp   = new DiffPairNMOS(vinp, vinn) { gnd=GND; tail=ntail; };
    tail = new TailCurrentSourcePMOS() { out=ntail; gate=vbias_n; gnd=GND; };

    // PMOS mirror group: diode @ n1 (sense), taps to n2, nmir, vout
    pm = mirror.PMOS(sense = dp.out_l, vdd = VDD, taps = { n2:1, nmir:2, vout:2 });

    // NMOS mirror group to ground: diode @ nmir, tap to vout
    nm = mirror.NMOS(sense = nmir, gnd = GND, taps = { vout:1 });
  }

  alias n1 = dp.out_l; alias n2 = dp.out_r;
}
